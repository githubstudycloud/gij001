server:
  port: 8888

spring:
  application:
    name: platform-config-server
  # Default to native profile for local development (no GitLab needed)
  profiles:
    active: ${CONFIG_PROFILE:native}

  cloud:
    config:
      server:
        # Native filesystem backend for local development
        native:
          search-locations:
            - file:${CONFIG_NATIVE_PATH:./docs/sample-config}/config/env{profile}
        # Git backend for production
        git:
          # GitLab repository URL
          uri: ${GITLAB_REPO_URL:http://192.168.0.99:8929/xz01/springconfig.git}
          # Branch to use (label)
          default-label: ${CONFIG_BRANCH:main}
          # Base directory for git clone (prevent cache in default temp dir)
          basedir: ${CONFIG_BASEDIR:${user.home}/config-repo}
          # Force pull on every request to get latest config
          force-pull: ${CONFIG_FORCE_PULL:true}
          # Search paths for configuration files
          # Structure: config/env{profile}/ contains GlobalConfig-pub.properties and {application}-v1-pub.properties
          search-paths:
            - 'config/env{profile}'
          # Authentication
          username: oauth2
          password: ${GITLAB_TOKEN:}
          # Clone on startup
          clone-on-start: ${CLONE_ON_START:false}
          # Skip SSL validation (for self-signed certificates)
          skip-ssl-validation: ${SKIP_SSL_VALIDATION:false}
          # Timeout settings
          timeout: 10
          # Refresh rate (seconds)
          refresh-rate: 0

management:
  endpoints:
    web:
      exposure:
        include: health,info,refresh,configserver
  endpoint:
    health:
      show-details: always

logging:
  level:
    org.springframework.cloud.config: DEBUG
    org.springframework.web: INFO
    com.platform.config: DEBUG

# API docs
springdoc:
  api-docs:
    enabled: true
  swagger-ui:
    enabled: true
