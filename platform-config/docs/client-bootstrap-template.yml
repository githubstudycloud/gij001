# ============================================
# Spring Cloud Config Client 配置模板
# 将此文件复制到客户端项目的 src/main/resources/bootstrap.yml
# ============================================

spring:
  application:
    # 应用名称，对应配置文件名 (不含 .properties 后缀)
    # 例如: project1-v1-pub 对应 config/env{profile}/project1-v1-pub.properties
    name: ${APP_NAME:project1-v1-pub}

  cloud:
    config:
      # Config Server 地址 (可配置多个，逗号分隔)
      uri: ${SPRING_CLOUD_CONFIG_URI:http://localhost:8888}

      # 环境配置 (beta/pro/test)
      # 会替换 search-paths 中的 {profile}，形成: config/envbeta, config/envpro, config/envtest
      profile: ${SPRING_PROFILES_ACTIVE:test}

      # Git 分支
      label: ${CONFIG_LABEL:main}

      # 配置文件名 (可指定多个，用逗号分隔)
      # 第一个是项目专属配置，第二个是全局公共配置
      name: ${CONFIG_NAME:${spring.application.name},GlobalConfig-pub}

      # 连接失败时快速失败
      fail-fast: ${CONFIG_FAIL_FAST:true}

      # 重试配置
      retry:
        enabled: true
        initial-interval: 1000
        max-attempts: 6
        max-interval: 2000
        multiplier: 1.1

      # 请求超时
      request-connect-timeout: 5000
      request-read-timeout: 10000

# ============================================
# 使用示例
# ============================================
#
# 1. 获取 test 环境配置:
#    java -jar app.jar --spring.profiles.active=test
#    或设置环境变量: SPRING_PROFILES_ACTIVE=test
#
# 2. 获取 beta 环境配置:
#    java -jar app.jar --spring.profiles.active=beta
#
# 3. 获取 pro 环境配置:
#    java -jar app.jar --spring.profiles.active=pro
#
# 4. 指定配置中心地址:
#    java -jar app.jar --spring.cloud.config.uri=http://config:8888
#    或设置环境变量: SPRING_CLOUD_CONFIG_URI=http://config:8888
#
# 5. 加载多个配置文件 (项目配置 + 全局配置):
#    spring.cloud.config.name=project1-v1-pub,GlobalConfig-pub
#    配置优先级: 项目配置 > 全局配置
#
# ============================================
# 配置文件对应关系
# ============================================
#
# profile=test  -> 搜索路径: config/envtest/
# profile=beta  -> 搜索路径: config/envbeta/
# profile=pro   -> 搜索路径: config/envpro/
#
# name=project1-v1-pub -> 文件: project1-v1-pub.properties
# name=GlobalConfig-pub -> 文件: GlobalConfig-pub.properties
